<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ZarzƒÖdzanie Dru≈ºynƒÖ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light container mt-5">

<div class="d-flex justify-content-between align-items-center mb-4">
    <a href="/trener" class="btn btn-outline-secondary">&larr; Wr√≥ƒá do panelu g≈Ç√≥wnego</a>
    <h2 class="fw-bold text-primary" th:text="${team.name}">Twoja Dru≈ºyna</h2>
</div>

<div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show">
    <span th:text="${successMessage}"></span>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
</div>
<div th:if="${errorMessage}" class="alert alert-danger alert-dismissible fade show">
    <span th:text="${errorMessage}"></span>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card shadow mb-4">
            <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0">üìã Aktualny Sk≈Çad</h5>
                <span class="badge bg-light text-dark" th:text="${squad.size()} + ' zawodnik√≥w'">0</span>
            </div>
            <div class="card-body p-0">
                <table class="table table-striped table-hover mb-0 align-middle">
                    <thead class="table-light">
                    <tr>
                        <th>#</th>
                        <th>Zawodnik</th>
                        <th>Narodowo≈õƒá</th>
                        <th>Status</th>
                        <th class="text-end">Akcja</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="member, iter : ${squad}">
                        <td th:text="${iter.count}">1</td>
                        <td class="fw-bold" th:text="${member.user.name} + ' ' + ${member.user.surname}"></td>
                        <td th:text="${member.user.nationality}"></td>
                        <td>
                            <span th:if="${member.contract.confirmed}" class="badge bg-success">‚úÖ W sk≈Çadzie</span>
                            <span th:unless="${member.contract.confirmed}" class="badge bg-warning text-dark">‚è≥ Oczekuje</span>
                        </td>
                        <td class="text-end">
                            <form th:action="@{/trener/usun-pilkarza}" method="post" onsubmit="return confirm('Potwierdzasz?');">
                                <input type="hidden" name="contractId" th:value="${member.contract.id}"/>
                                <button type="submit" class="btn btn-sm btn-outline-danger">
                                    <span th:if="${member.contract.confirmed}">‚ùå Usu≈Ñ</span>
                                    <span th:unless="${member.contract.confirmed}">üö´ Anuluj</span>
                                </button>
                            </form>
                        </td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(squad)}">
                        <td colspan="5" class="text-center py-5 text-muted">Pusto w szatni...</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="col-lg-4">

        <div class="card shadow mb-4 border-info">
            <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0">‚ÑπÔ∏è Informacje o Klubie</h5>
                <button class="btn btn-sm btn-light text-info fw-bold" data-bs-toggle="modal" data-bs-target="#editTeamModal">
                    ‚úèÔ∏è Edytuj
                </button>
            </div>
            <div class="card-body">
                <p class="mb-1"><strong>Stadion:</strong> <span th:text="${team.stadium}"></span></p>
                <p class="mb-1"><strong>Adres:</strong> <span th:text="${team.address}"></span></p>
                <hr>
                <p class="mb-1"><strong>Stroje domowe:</strong> <span th:text="${team.kitsHome}"></span></p>
                <p class="mb-0"><strong>Stroje wyjazdowe:</strong> <span th:text="${team.kitsAway}"></span></p>
            </div>
        </div>

        <div class="card shadow border-success">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">‚ûï Transfery</h5>
            </div>
            <div class="card-body">
                <form th:action="@{/trener/dodaj-pilkarza}" method="post">
                    <input type="hidden" name="teamId" th:value="${teamInLeagueId}"/> <div class="mb-3">
                    <label class="form-label fw-bold">Wolni zawodnicy:</label>
                    <select name="playerId" class="form-select" required>
                        <option value="" disabled selected>-- Wybierz --</option>
                        <option th:each="player : ${freePlayers}"
                                th:value="${player.id}"
                                th:text="${player.name} + ' ' + ${player.surname}"></option>
                    </select>
                </div>
                    <div class="d-grid">
                        <button type="submit" class="btn btn-success">üì© Wy≈õlij ofertƒô</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="editTeamModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-info text-white">
                <h5 class="modal-title">Edytuj dane dru≈ºyny</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form th:action="@{/trener/edytuj-druzyne}" method="post">
                    <input type="hidden" name="teamId" th:value="${team.id}"/>

                    <div class="mb-3">
                        <label class="form-label">Nazwa Klubu</label>
                        <input type="text" class="form-control" name="name" th:value="${team.name}" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Skr√≥t (3-4 znaki)</label>
                        <input type="text" class="form-control" name="abbreviation" th:value="${team.abbreviation}" required maxlength="4">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Stadion</label>
                        <input type="text" class="form-control" name="stadium" th:value="${team.stadium}" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Adres</label>
                        <input type="text" class="form-control" name="address" th:value="${team.address}" required>
                    </div>
                    <div class="row">
                        <div class="col-6 mb-3">
                            <label class="form-label">Stroje Domowe</label>
                            <input type="text" class="form-control" name="kitsHome" th:value="${team.kitsHome}" required>
                        </div>
                        <div class="col-6 mb-3">
                            <label class="form-label">Stroje Wyjazd.</label>
                            <input type="text" class="form-control" name="kitsAway" th:value="${team.kitsAway}" required>
                        </div>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-info text-white fw-bold">Zapisz zmiany</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>