<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Statystyki Meczu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light container mt-5">

<a th:href="@{/sedzia/mecze}" class="btn btn-outline-secondary mb-3">&larr; Wr√≥ƒá do listy mecz√≥w</a>

<div class="card shadow mb-4">
    <div class="card-header bg-dark text-white text-center">
        <h3 class="mb-0">Protok√≥≈Ç Meczowy</h3>
        <p class="mb-0 fs-5">
            Wynik: <span th:text="${match.homeScore}"></span> : <span th:text="${match.awayScore}"></span>
        </p>
    </div>
</div>

<div class="row">
    <div class="col-md-5">
        <div class="card shadow border-primary">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">‚ûï Dodaj Zdarzenie</h5>
            </div>
            <div class="card-body">
                <form th:action="@{/sedzia/mecze/statystyki/dodaj}" method="post">
                    <input type="hidden" name="matchId" th:value="${match.id}"/>

                    <div class="mb-3">
                        <label class="form-label fw-bold">Rodzaj zdarzenia:</label>
                        <select name="type" class="form-select" required>
                            <option value="0">‚öΩ Gol</option>
                            <option value="1">üü® ≈ª√≥≈Çta kartka</option>
                            <option value="2">üü• Czerwona kartka</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-bold">Wybierz zawodnika:</label>
                        <select name="contractId" class="form-select" required size="10">
                            <optgroup label="GOSPODARZE">
                                <option th:each="p : ${hostSquad}"
                                        th:value="${p.id}"
                                        th:text="${p.name} + ' ' + ${p.surname} + ' (#' + ${p.id} + ')'"></option>
                            </optgroup>
                            <optgroup label="GO≈öCIE">
                                <option th:each="p : ${awaySquad}"
                                        th:value="${p.id}"
                                        th:text="${p.name} + ' ' + ${p.surname} + ' (#' + ${p.id} + ')'"></option>
                            </optgroup>
                        </select>
                    </div>

                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary fw-bold">Zapisz</button>
                    </div>
                </form>
            </div>
        </div>

        <div th:if="${errorMessage}" class="alert alert-danger mt-3" th:text="${errorMessage}"></div>
        <div th:if="${successMessage}" class="alert alert-success mt-3" th:text="${successMessage}"></div>
    </div>

    <div class="col-md-7">
        <div class="card shadow">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">üìú Zapisane zdarzenia</h5>
            </div>
            <div class="card-body p-0">
                <table class="table table-striped mb-0 align-middle">
                    <thead>
                    <tr>
                        <th>Zdarzenie</th>
                        <th>Pi≈Çkarz</th>
                        <th class="text-end">Opcje</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="dto : ${stats}">
                        <td>
                            <span th:if="${dto.stat.type == 0}" class="badge bg-success">‚öΩ GOL</span>
                            <span th:if="${dto.stat.type == 1}" class="badge bg-warning text-dark">üü® ≈ª√≥≈Çta</span>
                            <span th:if="${dto.stat.type == 2}" class="badge bg-danger">üü• Czerwona</span>
                        </td>
                        <td class="fw-bold" th:text="${dto.playerName}">Jan Kowalski</td>

                        <td class="text-end">
                            <form th:if="${dto.stat.type == 2}"
                                  th:action="@{/sedzia/mecze/statystyki/wniosek}"
                                  method="post"
                                  class="d-inline-block me-1">

                                <input type="hidden" name="matchId" th:value="${match.id}"/>
                                <input type="hidden" name="contractId" th:value="${dto.stat.playerInTeamId}"/>
                                <input type="hidden" name="statId" th:value="${dto.stat.id}"/>

                                <button type="submit" class="btn btn-sm btn-warning fw-bold text-dark"
                                        title="Zg≈Ço≈õ wniosek o zawieszenie"
                                        onclick="return confirm('Zg≈Çosiƒá wniosek o zawieszenie dla tego zawodnika?');">
                                    ‚öñÔ∏è Zg≈Ço≈õ
                                </button>
                            </form>

                            <form th:action="@{/sedzia/mecze/statystyki/usun}" method="post" class="d-inline-block">
                                <input type="hidden" name="matchId" th:value="${match.id}"/>
                                <input type="hidden" name="statId" th:value="${dto.stat.id}"/>
                                <button type="submit" class="btn btn-sm btn-outline-danger" title="Usu≈Ñ wpis">‚ùå</button>
                            </form>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

</body>
</html>